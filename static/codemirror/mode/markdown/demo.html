<!--
 | @author xiangqian
 | @date 18:53 2022/12/22
 |-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!--
     | https://codemirror.net
     | GitHub: https://github.com/codemirror/codemirror5
     | doc: https://codemirror.net/5/doc/manual.html
     |-->
    <!-- 引入codemirror核心css文件 codemirror.css -->
    <link rel="stylesheet" href="../../lib/codemirror.css">

    <title>markdown</title>
</head>
<body>

<textarea type="text" style="width: 1000px; height: 500px;"></textarea>

</body>
</html>

<script src="../../../jquery/min.js"></script>

<!-- 引入codemirror核心js文件 codemirror.js -->
<script src="../../lib/codemirror.js"></script>
<!-- 引入codemirror mode代码高亮js -->
<script src="./markdown.js"></script>

<script>
    ;
    (function () {
        let $textarea = $('textarea')
        let editor = CodeMirror.fromTextArea($textarea[0], {
            mode: 'markdown', // 语言模式
            lineNumbers: true,  // 显示行数
            // indentUnit: 4,         // 缩进单位为4
            smartIndent: true, //智能缩进
            styleActiveLine: true, // 当前行背景高亮
            lineWrapping: true, // 自动换行
            matchBrackets: true,  // 括号匹配
            autoRefresh: true,
        })
        let width = $textarea.css('width')
        let height = $textarea.css('height')
        editor.setSize(width, height);

        // 内容变化监听
        // https://codemirror.net/5/doc/manual.html#events
        editor.on("changes", function () {
            // console.log($script.val())
            editor.refresh()
            editor.save()
            // console.log(editor.getValue())
            // console.log($script.val())
        })
    })()
    ;
</script>