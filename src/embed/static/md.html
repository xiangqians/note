<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Markdown</title>
</head>
<body>
<div id="toc"></div>
<div id="markdownContainer"></div>
</body>
</html>
<script type="text/javascript" src="/static/js/jquery.js"></script>
<script type="text/javascript" src="/static/js/markdown-it.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-emoji.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-sub.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-sup.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-ins.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-mark.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-footnote.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-deflist.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-task-lists.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-anchor.js"></script>
<script type="text/javascript" src="/static/js/markdown-it-toc-done-right.js"></script>
<script type="text/javascript" src="/static/js/highlight.js"></script>
<script>

    // 中文文档地址：
    // https://markdown-it.docschina.org/api/MarkdownIt.html

    // 创建 markdown-it 实例
    let md = window.markdownit(
        {
            html: true, // 可以识别html
            linkify: true, // 自动检测像链接的文本
            breaks: true, // 回车换行
            typographer: true, // 优化排版，标点
            // 代码高亮
            highlight: function (str, lang) {
                if (lang && hljs.getLanguage(lang)) {
                    try {
                        return '<pre class="hljs"><code>' + hljs.highlight(lang, str, true).value + '</code></pre>';
                    } catch (__) {
                    }
                }
                return '<pre class="hljs"><code>' + md.utils.escapeHtml(str) + '</code></pre>';
            }
        })
        // 注册 markdown-it-emoji 插件，用于解析和渲染 Emoji 表情
        .use(window.markdownitEmoji)
        // 注册 markdown-it-sub 插件，用于解析和渲染下标文本（例如 H~2~O）
        .use(window.markdownitSub)
        // 注册 markdown-it-sup 插件，用于解析和渲染上标文本（例如 x^2^）
        .use(window.markdownitSup)
        // 注册 markdown-it-ins 插件，用于解析和渲染插入线（ins标签）
        .use(window.markdownitIns)
        // 注册 markdown-it-mark 插件，用于解析和渲染标记文本（mark标签）
        .use(window.markdownitMark)
        // 注册 markdown-it-footnote 插件，用于解析和渲染脚注
        .use(window.markdownitFootnote)
        // 注册 markdown-it-deflist 插件，用于解析定义列表（定义术语和描述的列表）
        .use(window.markdownitDeflist)
        // 注册 markdown-it-task-lists 插件，用于解析任务列表（带有复选框的列表）
        .use(window.markdownitTaskLists)
        // 注册 markdown-it-anchor 插件
        .use(window.markdownItAnchor, {
            permalink: true, // 启用永久链接，默认为 false
            permalinkBefore: true, // 永久链接元素是否在标题前面，默认为 false
            permalinkClass: false, // 永久链接元素的 CSS 类，默认为 'header-anchor'
            permalinkSymbol: '§' // 永久链接符号，默认为 '¶'
        })
        // 注册 markdown-it-toc-done-right 插件
        .use(window.markdownItTocDoneRight, {
            containerClass: 'toc', // 生成的容器的类名，这样最后返回来的字符串是 <nav class="toc"><nav/>
            containerId: 'toc', // 生成的容器的ID，这样最后返回来的字符串是 <nav id="toc"><nav/>
            listType: 'ul', // 导航列表使用ul还是ol
            listClass: 'listClass', // li标签的样式名
            itemClass: 'itemClass',
            linkClass: 'linkClass', // a标签的样式名
            callback: function (html, ast) {
                // 把目录单独列出来
                document.getElementById('toc').innerHTML = html
            },
            level: [1, 2, 3], // 设置生成目录的标题级别
        })

    // 要解析的 Markdown 文本
    let markdownText = ''
    $.ajax({
        url: '/static/md.txt',
        dataType: 'text',
        async: false,
        success: function (content) {
            markdownText = content
        },
        error: function (xhr, status, error) {
            throw new Error(error)
        }
    })

    // 解析 Markdown 文本
    let result = md.render(markdownText)

    // 获取要插入内容的容器元素
    let container = document.getElementById('markdownContainer');

    // 将解析结果插入容器元素
    container.innerHTML = result;


</script>